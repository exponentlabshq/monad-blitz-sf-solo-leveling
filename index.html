<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exponential Individuals - 10X Intelligence</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
      padding: 20px; 
      max-width: 1200px; 
      margin: 0 auto; 
      background: #FBFAF9; 
      color: #1B1D21;
    }
    h1 { 
      margin-bottom: 20px; 
      color: #1B1D21; 
      font-family: 'Inter', sans-serif;
      font-weight: 700;
    }
    .input-section {
      background: #FFFFFF;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      margin-bottom: 20px;
      border: 1px solid rgba(110, 84, 255, 0.05);
    }
    #handle { 
      width: 100%; 
      padding: 12px; 
      font-size: 16px; 
      border: 1px solid rgba(110, 84, 255, 0.2); 
      border-radius: 4px; 
      margin-bottom: 10px; 
      font-family: 'Inter', sans-serif;
      color: #1B1D21;
    }
    #handle:focus { 
      outline: none; 
      border-color: #6E54FF; 
      box-shadow: 0 0 0 2px rgba(110, 84, 255, 0.2);
    }
    button { 
      width: 100%; 
      padding: 12px; 
      background: #6E54FF; 
      color: #FFFFFF; 
      border: none; 
      font-size: 16px; 
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      cursor: pointer; 
      border-radius: 4px; 
      transition: background 0.2s ease;
    }
    button:hover { background: rgba(110, 84, 255, 0.9); }
    button:focus { 
      outline: 2px solid #6E54FF; 
      outline-offset: 2px; 
    }
    button:disabled { 
      background: rgba(110, 84, 255, 0.5); 
      cursor: not-allowed; 
    }
    .loading { text-align: center; padding: 40px; color: #1B1D21; }
    .loading-progress { margin-top: 10px; font-size: 14px; font-family: 'Inter', sans-serif; }
    #result { margin-top: 20px; }
    .section { 
      background: #FFFFFF; 
      padding: 30px; 
      border-radius: 8px; 
      box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
      margin-bottom: 20px; 
      border: 1px solid rgba(110, 84, 255, 0.05);
    }
    .section-title { 
      font-size: 24px; 
      margin-bottom: 20px; 
      color: #1B1D21; 
      border-bottom: 2px solid rgba(110, 84, 255, 0.1); 
      padding-bottom: 10px; 
      font-family: 'Inter', sans-serif;
      font-weight: 700;
    }
    .score-container { 
      text-align: center; 
      padding: 40px; 
      background: linear-gradient(135deg, #6E54FF 0%, rgba(110, 84, 255, 0.8) 100%); 
      color: #FFFFFF; 
      border-radius: 8px; 
      margin-bottom: 20px; 
      position: relative;
      overflow: hidden;
    }
    .score-value { 
      font-size: 72px; 
      font-weight: bold; 
      margin: 20px 0; 
      font-family: 'Roboto Mono', monospace;
    }
    .score-label { 
      font-size: 18px; 
      opacity: 0.9; 
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }
    .metrics-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
      gap: 15px; 
      margin: 20px 0; 
    }
    .metric-card { 
      background: #FFFFFF; 
      padding: 15px; 
      border-radius: 8px; 
      border: 1px solid rgba(110, 84, 255, 0.1);
    }
    .metric-value { 
      font-size: 28px; 
      font-weight: bold; 
      color: #6E54FF; 
      font-family: 'Roboto Mono', monospace;
      text-transform: uppercase;
    }
    .metric-label { 
      font-size: 12px; 
      color: #1B1D21; 
      text-transform: uppercase; 
      margin-top: 5px; 
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }
    .interactor-card { 
      display: flex; 
      align-items: center; 
      padding: 15px; 
      background: #FFFFFF; 
      border-radius: 8px; 
      margin-bottom: 10px; 
      border: 1px solid rgba(110, 84, 255, 0.05);
    }
    .interactor-avatar { width: 50px; height: 50px; border-radius: 50%; margin-right: 15px; }
    .interactor-info { flex: 1; }
    .interactor-name { 
      font-weight: 600; 
      font-family: 'Inter', sans-serif;
      color: #1B1D21;
    }
    .interactor-handle { 
      color: #1B1D21; 
      font-size: 14px; 
      opacity: 0.7;
      font-family: 'Inter', sans-serif;
    }
    .interactor-count { 
      font-size: 18px; 
      font-weight: bold; 
      color: #6E54FF; 
      font-family: 'Roboto Mono', monospace;
    }
    .topic-tag { 
      display: inline-block; 
      background: rgba(110, 84, 255, 0.1); 
      color: #6E54FF; 
      padding: 6px 12px; 
      border-radius: 20px; 
      font-size: 12px; 
      margin: 5px 5px 5px 0; 
      border: 1px solid rgba(110, 84, 255, 0.2);
      font-family: 'Inter', sans-serif;
      font-weight: 500;
    }
    .topic-tag .rank { 
      background: #6E54FF; 
      color: #FFFFFF; 
      padding: 2px 6px; 
      border-radius: 10px; 
      margin-left: 5px; 
      font-family: 'Roboto Mono', monospace;
    }
    .post-item { padding: 15px; border-bottom: 1px solid #eee; }
    .post-item:last-child { border-bottom: none; }
    .chart-container { position: relative; height: 300px; margin: 20px 0; }
    .chart-container.large { height: 400px; }
    .charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin: 20px 0; }
    @media (max-width: 768px) {
      .charts-grid { grid-template-columns: 1fr; }
      .chart-container { height: 250px; }
      .chart-container.large { height: 300px; }
    }
    .post-text { margin-bottom: 8px; }
    .post-meta { font-size: 12px; color: #666; }
    .trend-up { color: #85E6FF; }
    .trend-down { color: #FF8EE4; }
    .trend-neutral { color: #1B1D21; opacity: 0.6; }
    .error { 
      color: #1B1D21; 
      padding: 15px; 
      background: rgba(255, 142, 228, 0.1); 
      border-left: 4px solid #FF8EE4;
      border-radius: 4px; 
      font-family: 'Inter', sans-serif;
    }
    #json { 
      background: #0E091C; 
      color: #85E6FF; 
      padding: 20px; 
      overflow-x: auto; 
      margin-top: 20px; 
      font-size: 11px; 
      border-radius: 8px; 
      max-height: 600px; 
      overflow-y: auto; 
      font-family: 'Roboto Mono', monospace;
      border: 1px solid rgba(110, 84, 255, 0.2);
    }
    .data-stats { 
      background: rgba(221, 215, 254, 0.3); 
      padding: 15px; 
      border-radius: 8px; 
      margin-bottom: 20px; 
      font-size: 14px; 
      font-family: 'Inter', sans-serif;
      border: 1px solid rgba(110, 84, 255, 0.1);
    }
    .insight-box { 
      background: rgba(255, 174, 69, 0.1); 
      border-left: 4px solid #FFAE45; 
      padding: 15px; 
      margin: 15px 0; 
      border-radius: 4px; 
      font-family: 'Inter', sans-serif;
    }
    .insight-title { 
      font-weight: 600; 
      margin-bottom: 8px; 
      color: #1B1D21;
      font-family: 'Inter', sans-serif;
    }
    @media (max-width: 768px) {
      .metrics-grid { grid-template-columns: 1fr; }
      .score-value { font-size: 48px; }
    }
  </style>
</head>
<body>
  <h1>Exponential Individuals - 10X Intelligence</h1>
  
  <div class="input-section">
    <input type="text" id="handle" placeholder="@username or username" autofocus>
    <button onclick="generateReport()" id="analyzeBtn">Generate Comprehensive Report</button>
  </div>
  
  <div id="result"></div>
  <pre id="json"></pre>
  
  <script>
    const API_KEY = 'INSERT-API-KEY-HERE';
    const API_BASE = 'https://lunarcrush.com/api4';
    
    async function generateReport() {
      const handle = document.getElementById('handle').value.replace('@', '').toLowerCase().trim();
      if (!handle) {
        alert('Please enter a Twitter handle');
        return;
      }
      
      const resultDiv = document.getElementById('result');
      const jsonDiv = document.getElementById('json');
      const btn = document.getElementById('analyzeBtn');
      
      resultDiv.innerHTML = '<div class="loading">Loading comprehensive data...<div class="loading-progress" id="progress">Initializing...</div></div>';
      jsonDiv.textContent = '';
      btn.disabled = true;
      
      const reportData = {
        handle: handle,
        generated_at: new Date().toISOString(),
        version: '10X-Intelligence-v1.0'
      };
      
      try {
        // Update progress
        updateProgress('Fetching creator data...');
        
        // 1. Creator Data
        let creatorUrl = `${API_BASE}/public/creator/twitter/${handle}/v1?key=${API_KEY}`;
        let creatorResponse = await fetch(creatorUrl);
        let creatorData = await creatorResponse.json();
        
        if (creatorData.error || !creatorData.data) {
          throw new Error(creatorData.error?.message || 'Creator not found');
        }
        
        const creator = creatorData.data;
        
        // Capture ALL creator fields (comprehensive)
        reportData.creator = {
          id: creator.creator_id,
          name: creator.creator_name,
          display_name: creator.creator_display_name,
          avatar: creator.creator_avatar,
          followers: creator.creator_followers || 0,
          creator_rank: creator.creator_rank || null,
          interactions_24h: creator.interactions_24h || 0,
          posts_active_24h: creator.posts_active || 0,
          posts_created_24h: creator.posts_created || 0,
          verified: creator.verified || false,
          // Capture any other fields that exist
          ...(creator.engagement_rate && { engagement_rate: creator.engagement_rate }),
          ...(creator.avg_engagement_rate && { avg_engagement_rate: creator.avg_engagement_rate }),
          ...(creator.sentiment && { sentiment: creator.sentiment }),
          ...(creator.social_dominance && { social_dominance: creator.social_dominance })
        };
        
        // 2. Time Series Data (if available)
        updateProgress('Fetching time series data...');
        try {
          const timeSeriesUrl = `${API_BASE}/public/creator/twitter/${handle}/time-series/v1?key=${API_KEY}`;
          const timeSeriesResponse = await fetch(timeSeriesUrl);
          const timeSeriesData = await timeSeriesResponse.json();
          if (timeSeriesData.data) {
            reportData.time_series = timeSeriesData.data;
          }
        } catch (e) {
          console.log('Time series not available');
        }
        
        // 3. Top Posts
        updateProgress('Fetching top posts...');
        try {
          const postsUrl = `${API_BASE}/public/creator/twitter/${handle}/posts/v1?key=${API_KEY}`;
          const postsResponse = await fetch(postsUrl);
          const postsData = await postsResponse.json();
          if (postsData.data && Array.isArray(postsData.data)) {
            reportData.top_posts = postsData.data; // All available posts
            // Sort posts by interactions_total to get top posts
            const sortedPosts = [...postsData.data].sort((a, b) => 
              (b.interactions_total || 0) - (a.interactions_total || 0)
            );
            
            reportData.posts_analysis = {
              total_posts: postsData.data.length,
              total_interactions: postsData.data.reduce((sum, p) => sum + (p.interactions_total || p.interactions_24h || 0), 0),
              avg_interactions: postsData.data.length > 0 ? 
                postsData.data.reduce((sum, p) => sum + (p.interactions_total || p.interactions_24h || 0), 0) / postsData.data.length : 0,
              top_post: sortedPosts[0] || null,
              top_5_posts: sortedPosts.slice(0, 5),
              posts_with_high_engagement: postsData.data.filter(p => (p.interactions_total || p.interactions_24h || 0) > 100).length,
              viral_posts: postsData.data.filter(p => (p.interactions_total || 0) > 500).length
            };
            
            // Store sorted posts
            reportData.top_posts = sortedPosts;
          }
        } catch (e) {
          console.log('Posts not available:', e);
          reportData.top_posts = [];
          reportData.posts_analysis = {
            total_posts: 0,
            total_interactions: 0,
            avg_interactions: 0,
            top_post: null,
            top_5_posts: [],
            posts_with_high_engagement: 0,
            viral_posts: 0,
            error: 'Posts data unavailable'
          };
        }
        
        // 4. Topic Influence (with detailed analysis)
        updateProgress('Analyzing topic influence...');
        reportData.topic_influence = creator.topic_influence || [];
        reportData.topic_analysis = {
          total_topics: (creator.topic_influence || []).length,
          top_topic: (creator.topic_influence && creator.topic_influence[0]) || null,
          total_influence_percent: (creator.topic_influence || []).reduce((sum, t) => sum + (t.percent || 0), 0),
          ranked_topics: (creator.topic_influence || []).filter(t => t.rank).length
        };
        
        // 5. Social Category Influence (with analysis)
        // Check multiple possible field names
        const categoryInfluence = creator.category_influence || creator.social_category_influence || creator.categories || [];
        reportData.category_influence = categoryInfluence;
        reportData.category_analysis = {
          total_categories: categoryInfluence.length,
          top_category: categoryInfluence[0] || null,
          total_influence_percent: categoryInfluence.reduce((sum, c) => sum + (c.percent || c.influence || 0), 0),
          categories: categoryInfluence.map(c => ({
            name: c.category || c.name || c,
            percent: c.percent || c.influence || 0
          }))
        };
        
        // 6. Top Community (Full Network with analysis)
        updateProgress('Mapping network...');
        const topCommunity = creator.top_community || [];
        reportData.network = {
          top_community: topCommunity,
          total_connections: topCommunity.length,
          network_analysis: {
            total_interactions: topCommunity.reduce((sum, c) => sum + (c.count || 0), 0),
            avg_interactions_per_connection: topCommunity.length > 0 ? 
              topCommunity.reduce((sum, c) => sum + (c.count || 0), 0) / topCommunity.length : 0,
            top_connection: topCommunity[0] || null,
            connections_with_avatars: topCommunity.filter(c => c.creator_avatar).length
          }
        };
        
        // 7. Top Assets Mentioned (with market context)
        // Check multiple possible field names
        const assetsMentioned = creator.assets_mentioned || creator.mentioned_assets || creator.assets || [];
        reportData.assets_mentioned = assetsMentioned;
        reportData.assets_analysis = {
          total_assets: assetsMentioned.length,
          crypto_assets: assetsMentioned.filter(a => (a.type === 'crypto' || !a.type) && a.symbol).length,
          stock_assets: assetsMentioned.filter(a => a.type === 'stock').length,
          top_assets: assetsMentioned.slice(0, 10).map(a => ({
            symbol: a.symbol || a.name,
            name: a.name || a.symbol,
            type: a.type || 'crypto',
            mentions: a.count || a.mentions || 0
          }))
        };
        
        // 8. Additional creator metadata
        reportData.creator_metadata = {
          display_name: creator.creator_display_name,
          avatar_url: creator.creator_avatar,
          account_age_estimate: null, // Could calculate from first post date
          verified_status: creator.verified || false
        };
        
        // 8. Calculate Advanced Metrics
        updateProgress('Calculating advanced metrics...');
        const metrics = calculateAdvancedMetrics(creator, reportData);
        reportData.metrics = metrics;
        
        // 9. Generate Investment Score
        const investmentScore = calculateInvestmentScore(metrics, reportData);
        reportData.investment_readiness_score = investmentScore;
        
        // 10. Generate Insights
        updateProgress('Generating insights...');
        reportData.insights = generateInsights(reportData, metrics, investmentScore);
        
        // 11. Generate Narrative
        reportData.narrative = generateNarrative(reportData, investmentScore);
        
        // 11b. Capture any additional fields we might have missed
        reportData.additional_data = {
          // Check for any other fields in creator object
          posts_created: creator.posts_created || 0,
          sentiment: creator.sentiment || null,
          social_dominance: creator.social_dominance || null,
          engagement_rate_api: creator.engagement_rate || null,
          // Capture all other fields that exist
          all_fields: Object.keys(creator).filter(k => 
            !['creator_id', 'creator_name', 'creator_display_name', 'creator_avatar', 
              'creator_followers', 'creator_rank', 'interactions_24h', 'posts_active',
              'topic_influence', 'top_community', 'category_influence', 'assets_mentioned'].includes(k)
          ).reduce((acc, key) => {
            if (creator[key] !== undefined && creator[key] !== null) {
              acc[key] = creator[key];
            }
            return acc;
          }, {})
        };
        
        // 12. Calculate additional derived metrics
        updateProgress('Calculating derived metrics...');
        reportData.derived_metrics = {
          engagement_velocity: calculateEngagementVelocity(reportData),
          network_density: calculateNetworkDensity(reportData),
          content_consistency: calculateContentConsistency(reportData),
          influence_score: calculateInfluenceScore(reportData),
          exponential_indicators: calculateExponentialIndicators(reportData, metrics, investmentScore)
        };
        
        // 13. Generate recommendations
        reportData.recommendations = generateRecommendations(reportData, investmentScore);
        
        // 14. Add metadata
        reportData.metadata = {
          data_quality: 'high',
          data_freshness: new Date().toISOString(),
          data_sources: ['lunarcrush_api_v4'],
          api_endpoints_used: [
            'creator/twitter/{handle}/v1',
            'creator/twitter/{handle}/time-series/v1',
            'creator/twitter/{handle}/posts/v1'
          ],
          total_data_points: countDataPoints(reportData),
          report_version: '10X-Intelligence-v1.0'
        };
        
        // 15. Store raw data (complete)
        reportData.raw_data = {
          creator_response: creatorData,
          timestamp: new Date().toISOString()
        };
        
        // Display Results
        displayResults(reportData, resultDiv);
        jsonDiv.textContent = JSON.stringify(reportData, null, 2);
        
        // Store for download
        window.reportData = reportData;
        
        // Add download button
        resultDiv.innerHTML += '<div class="section"><button onclick="downloadJSON()" style="margin-top: 20px;">Download Complete JSON Report</button></div>';
        
      } catch (error) {
        resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
        jsonDiv.textContent = '';
      } finally {
        btn.disabled = false;
      }
    }
    
    function updateProgress(message) {
      const progressEl = document.getElementById('progress');
      if (progressEl) progressEl.textContent = message;
    }
    
    function calculateAdvancedMetrics(creator, reportData) {
      const followers = creator.creator_followers || 0;
      const interactions = creator.interactions_24h || 0;
      const posts = creator.posts_active || 0;
      
      // Engagement Rate
      const engagementRate = followers > 0 ? (interactions / followers) * 100 : 0;
      
      // Average Engagement per Post
      const avgEngagementPerPost = posts > 0 ? interactions / posts : 0;
      
      // Network Quality Score (based on top community size and diversity)
      const networkSize = (creator.top_community || []).length;
      const networkQuality = Math.min(100, (networkSize / 20) * 100);
      
      // Topic Influence Score (sum of percentages)
      const topicInfluenceScore = (creator.topic_influence || []).reduce((sum, t) => sum + (t.percent || 0), 0);
      
      // Category Diversity Score
      const categoryCount = (creator.category_influence || []).length;
      const categoryDiversity = Math.min(100, categoryCount * 12.5);
      
      // Growth Metrics (if time series available)
      let growthVelocity = 0;
      let momentum = 'neutral';
      if (reportData.time_series) {
        // Calculate growth from time series
        growthVelocity = 0; // Placeholder
        momentum = 'neutral';
      }
      
      return {
        engagement_rate: engagementRate,
        avg_engagement_per_post: avgEngagementPerPost,
        network_quality_score: networkQuality,
        topic_influence_score: topicInfluenceScore,
        category_diversity_score: categoryDiversity,
        growth_velocity: growthVelocity,
        momentum: momentum,
        creator_rank: creator.creator_rank || null,
        network_size: networkSize,
        posts_count_24h: posts,
        interactions_count_24h: interactions
      };
    }
    
    function calculateInvestmentScore(metrics, reportData) {
      // Multi-factor weighted scoring
      let score = 0;
      
      // Engagement Rate (30%)
      const engagementScore = Math.min(100, metrics.engagement_rate * 10);
      score += engagementScore * 0.30;
      
      // Network Quality (25%)
      score += metrics.network_quality_score * 0.25;
      
      // Topic Influence (20%)
      const topicScore = Math.min(100, metrics.topic_influence_score * 10);
      score += topicScore * 0.20;
      
      // Category Diversity (15%)
      score += metrics.category_diversity_score * 0.15;
      
      // Creator Rank (10%) - Lower rank is better
      let rankScore = 0;
      if (metrics.creator_rank) {
        // Normalize rank (lower is better, so invert)
        rankScore = Math.max(0, 100 - (metrics.creator_rank / 100000));
      }
      score += rankScore * 0.10;
      
      return Math.round(Math.min(100, score));
    }
    
    function generateInsights(reportData, metrics, score) {
      const insights = [];
      
      // Engagement Insight
      if (metrics.engagement_rate > 5) {
        insights.push({
          type: 'positive',
          title: 'High Engagement Rate',
          message: `Engagement rate of ${metrics.engagement_rate.toFixed(2)}% indicates strong community connection.`
        });
      } else if (metrics.engagement_rate < 1) {
        insights.push({
          type: 'warning',
          title: 'Low Engagement Rate',
          message: `Engagement rate of ${metrics.engagement_rate.toFixed(2)}% suggests limited community interaction.`
        });
      }
      
      // Network Insight
      if (reportData.network.total_connections > 15) {
        insights.push({
          type: 'positive',
          title: 'Strong Network',
          message: `Connected with ${reportData.network.total_connections} top accounts, indicating strong ecosystem presence.`
        });
      }
      
      // Topic Influence Insight
      if (metrics.topic_influence_score > 10) {
        insights.push({
          type: 'positive',
          title: 'Topic Authority',
          message: `Significant influence across ${(reportData.topic_influence || []).length} topics.`
        });
      }
      
      // Creator Rank Insight
      if (metrics.creator_rank && metrics.creator_rank < 1000000) {
        insights.push({
          type: 'positive',
          title: 'Strong Creator Rank',
          message: `Ranked #${metrics.creator_rank.toLocaleString()} globally, indicating high influence.`
        });
      }
      
      return insights;
    }
    
    function calculateEngagementVelocity(reportData) {
      // Calculate rate of engagement growth
      const interactions = reportData.creator.interactions_24h || 0;
      const followers = reportData.creator.followers || 1;
      return (interactions / followers) * 100;
    }
    
    function calculateNetworkDensity(reportData) {
      const network = reportData.network.top_community || [];
      if (network.length === 0) return 0;
      const totalInteractions = network.reduce((sum, n) => sum + (n.count || 0), 0);
      return totalInteractions / network.length;
    }
    
    function calculateContentConsistency(reportData) {
      const posts = reportData.top_posts || [];
      if (posts.length === 0) return 0;
      // Calculate consistency based on engagement variance
      const interactions = posts.map(p => p.interactions_total || p.interactions_24h || 0);
      if (interactions.length === 0 || interactions.reduce((a, b) => a + b, 0) === 0) return 0;
      const avg = interactions.reduce((a, b) => a + b, 0) / interactions.length;
      const variance = interactions.reduce((sum, e) => sum + Math.pow(e - avg, 2), 0) / interactions.length;
      return Math.max(0, 100 - (variance / (avg || 1)) * 10); // Lower variance = higher consistency
    }
    
    function calculateInfluenceScore(reportData) {
      let score = 0;
      // Creator rank (lower is better)
      if (reportData.metrics.creator_rank) {
        score += Math.max(0, 50 - (reportData.metrics.creator_rank / 100000));
      }
      // Topic influence
      score += Math.min(30, reportData.metrics.topic_influence_score * 3);
      // Network quality
      score += reportData.metrics.network_quality_score * 0.2;
      return Math.min(100, score);
    }
    
    function calculateExponentialIndicators(reportData, metrics, investmentScore) {
      const indicators = [];
      
      // High engagement rate
      if (metrics.engagement_rate > 5) {
        indicators.push({
          type: 'positive',
          indicator: 'high_engagement',
          message: 'Engagement rate above 5% indicates strong community connection',
          strength: 'strong'
        });
      }
      
      // Large network
      if (reportData.network.total_connections > 15) {
        indicators.push({
          type: 'positive',
          indicator: 'large_network',
          message: `Connected with ${reportData.network.total_connections} top accounts`,
          strength: 'strong'
        });
      }
      
      // Topic authority
      if (reportData.topic_analysis && reportData.topic_analysis.ranked_topics > 0) {
        indicators.push({
          type: 'positive',
          indicator: 'topic_authority',
          message: `Ranked in ${reportData.topic_analysis.ranked_topics} topics`,
          strength: 'moderate'
        });
      }
      
      // Growth potential
      if (investmentScore >= 60) {
        indicators.push({
          type: 'positive',
          indicator: 'growth_potential',
          message: 'Investment score indicates strong exponential potential',
          strength: 'strong'
        });
      }
      
      return indicators;
    }
    
    function generateRecommendations(reportData, score) {
      const recommendations = [];
      
      if (score >= 70) {
        recommendations.push({
          priority: 'high',
          action: 'Strong Investment Opportunity',
          reasoning: 'High investment readiness score indicates exceptional potential',
          next_steps: ['Deep dive into network connections', 'Analyze content performance trends', 'Monitor growth trajectory']
        });
      } else if (score >= 50) {
        recommendations.push({
          priority: 'medium',
          action: 'Monitor and Evaluate',
          reasoning: 'Moderate score suggests potential with room for growth',
          next_steps: ['Track engagement trends', 'Assess network expansion', 'Evaluate content strategy']
        });
      } else {
        recommendations.push({
          priority: 'low',
          action: 'Further Analysis Required',
          reasoning: 'Lower score indicates need for deeper investigation',
          next_steps: ['Review engagement patterns', 'Assess network quality', 'Evaluate growth trajectory']
        });
      }
      
      // Network-specific recommendations
      if (reportData.network && reportData.network.total_connections < 10) {
        recommendations.push({
          priority: 'medium',
          action: 'Network Expansion Opportunity',
          reasoning: 'Limited network connections may indicate early stage or niche focus',
          next_steps: ['Identify key network gaps', 'Assess connection quality over quantity']
        });
      }
      
      return recommendations;
    }
    
    function countDataPoints(reportData) {
      let count = 0;
      count += Object.keys(reportData.creator || {}).length;
      count += (reportData.network?.top_community || []).length;
      count += (reportData.topic_influence || []).length;
      count += (reportData.category_influence || []).length;
      count += (reportData.top_posts || []).length;
      count += Object.keys(reportData.metrics || {}).length;
      count += (reportData.insights || []).length;
      count += (reportData.recommendations || []).length;
      return count;
    }
    
    function generateNarrative(reportData, score) {
      const handle = reportData.handle;
      const followers = reportData.creator?.followers || 0;
      const networkSize = reportData.network?.total_connections || 0;
      const topics = (reportData.topic_influence || []).length;
      
      let narrative = `@${handle} presents an `;
      
      if (score >= 70) {
        narrative += `exceptional investment opportunity with a score of ${score}/100. `;
      } else if (score >= 50) {
        narrative += `promising investment profile with a score of ${score}/100. `;
      } else {
        narrative += `emerging profile with a score of ${score}/100. `;
      }
      
      narrative += `With ${followers.toLocaleString()} followers and connections to ${networkSize} top accounts, `;
      narrative += `this individual demonstrates influence across ${topics} key topics. `;
      
      if ((reportData.topic_influence || []).length > 0) {
        const topTopic = reportData.topic_influence[0];
        narrative += `Primary focus: ${topTopic?.topic || 'N/A'} (rank #${topTopic?.rank || 'N/A'}). `;
      }
      
      narrative += `The network quality and engagement patterns suggest ${score >= 60 ? 'strong exponential potential' : 'growth potential'}.`;
      
      return narrative;
    }
    
    // Chart rendering functions
    function renderTimeSeriesChart(data, canvasId) {
      if (!data || data.length === 0) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      // Process time series data
      const labels = data.map(d => {
        const date = new Date(d.time * 1000);
        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      });
      
      const interactions = data.map(d => d.interactions || 0);
      const postsActive = data.map(d => d.posts_active || 0);
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Interactions',
            data: interactions,
            borderColor: '#6E54FF',
            backgroundColor: 'rgba(110, 84, 255, 0.1)',
            tension: 0.4,
            fill: true
          }, {
            label: 'Active Posts',
            data: postsActive,
            borderColor: '#85E6FF',
            backgroundColor: 'rgba(133, 230, 255, 0.1)',
            tension: 0.4,
            fill: true,
            yAxisID: 'y1'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { 
              display: true, 
              position: 'top',
              labels: {
                font: {
                  family: 'Inter',
                  size: 12
                },
                color: '#1B1D21'
              }
            },
            title: { 
              display: true, 
              text: 'Engagement Trends Over Time',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          },
          scales: {
            y: { 
              beginAtZero: true, 
              title: { display: true, text: 'Interactions' },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            },
            y1: { 
              beginAtZero: true, 
              position: 'right', 
              title: { display: true, text: 'Active Posts' },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(133, 230, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                font: {
                  family: 'Inter',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderTopicInfluenceChart(data, canvasId) {
      if (!data || data.length === 0) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      const topTopics = data.slice(0, 10);
      const labels = topTopics.map(t => t.topic);
      const values = topTopics.map(t => t.percent || 0);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Influence %',
            data: values,
            backgroundColor: 'rgba(110, 84, 255, 0.8)',
            borderColor: '#6E54FF',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            title: { 
              display: true, 
              text: 'Topic Influence Distribution',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          },
          scales: {
            y: { 
              beginAtZero: true, 
              title: { display: true, text: 'Influence (%)' },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                font: {
                  family: 'Inter',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderNetworkConnectionsChart(data, canvasId) {
      if (!data || data.length === 0) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      const topConnections = data.slice(0, 15);
      const labels = topConnections.map(c => c.creator_name || 'Unknown');
      const values = topConnections.map(c => c.count || 0);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Interactions',
            data: values,
            backgroundColor: 'rgba(133, 230, 255, 0.8)',
            borderColor: '#85E6FF',
            borderWidth: 1
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            title: { 
              display: true, 
              text: 'Top Network Connections',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          },
          scales: {
            x: { 
              beginAtZero: true, 
              title: { display: true, text: 'Interaction Count' },
              ticks: { 
                maxRotation: 0, 
                minRotation: 0,
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            },
            y: {
              ticks: { 
                maxRotation: 0,
                font: {
                  family: 'Inter',
                  size: 11
                },
                color: '#1B1D21',
                callback: function(value, index) {
                  const label = this.getLabelForValue(value);
                  return label.length > 15 ? label.substring(0, 15) + '...' : label;
                }
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderPostsPerformanceChart(data, canvasId) {
      if (!data || data.length === 0) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      const topPosts = data.slice(0, 10);
      const labels = topPosts.map((p, i) => `Post #${i + 1}`);
      const interactions = topPosts.map(p => p.interactions_total || p.interactions_24h || 0);
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Total Interactions',
            data: interactions,
            backgroundColor: 'rgba(255, 174, 69, 0.8)',
            borderColor: '#FFAE45',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            title: { 
              display: true, 
              text: 'Top Posts Performance',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          },
          scales: {
            y: { 
              beginAtZero: true, 
              title: { display: true, text: 'Interactions' },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                font: {
                  family: 'Inter',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderEngagementMetricsChart(data, canvasId) {
      if (!data) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      new Chart(ctx, {
        type: 'doughnut',
        data: {
          labels: ['Engagement Rate', 'Network Quality', 'Topic Influence', 'Growth Potential'],
          datasets: [{
            data: [
              data.engagement_rate || 0,
              data.network_quality_score || 0,
              data.topic_influence_score || 0,
              data.growth_velocity || 0
            ],
            backgroundColor: [
              'rgba(110, 84, 255, 0.8)',
              'rgba(133, 230, 255, 0.8)',
              'rgba(255, 174, 69, 0.8)',
              'rgba(255, 142, 228, 0.8)'
            ],
            borderWidth: 2,
            borderColor: '#FFFFFF'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { 
              display: true, 
              position: 'right',
              labels: {
                font: {
                  family: 'Inter',
                  size: 12
                },
                color: '#1B1D21'
              }
            },
            title: { 
              display: true, 
              text: 'Engagement Metrics Breakdown',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          }
        }
      });
    }
    
    function renderTopPostsComparisonChart(postsAnalysis, canvasId) {
      if (!postsAnalysis || !postsAnalysis.top_5_posts || postsAnalysis.top_5_posts.length === 0) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      const posts = postsAnalysis.top_5_posts;
      const labels = posts.map((p, i) => {
        const text = p.post_title || p.text || `Post ${i + 1}`;
        return text.length > 30 ? text.substring(0, 30) + '...' : text;
      });
      const interactions = posts.map(p => p.interactions_total || p.interactions_24h || 0);
      const sentiment = posts.map(p => (p.post_sentiment || 0) * 20); // Scale 0-5 to 0-100
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Total Interactions',
            data: interactions,
            backgroundColor: 'rgba(110, 84, 255, 0.8)',
            borderColor: '#6E54FF',
            borderWidth: 1,
            yAxisID: 'y'
          }, {
            label: 'Sentiment Score (scaled)',
            data: sentiment,
            backgroundColor: 'rgba(133, 230, 255, 0.6)',
            borderColor: '#85E6FF',
            borderWidth: 1,
            yAxisID: 'y1'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { 
              display: true, 
              position: 'top',
              labels: {
                font: {
                  family: 'Inter',
                  size: 12
                },
                color: '#1B1D21'
              }
            },
            title: { 
              display: true, 
              text: 'Top 5 Posts: Engagement vs Sentiment',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          },
          scales: {
            y: { 
              beginAtZero: true, 
              position: 'left',
              title: { display: true, text: 'Interactions' },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            },
            y1: { 
              beginAtZero: true, 
              position: 'right',
              title: { display: true, text: 'Sentiment (scaled)' },
              grid: { drawOnChartArea: false },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              }
            },
            x: {
              ticks: {
                font: {
                  family: 'Inter',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function renderGrowthTrendChart(timeSeries, canvasId) {
      if (!timeSeries || timeSeries.length === 0) return;
      
      const ctx = document.getElementById(canvasId);
      if (!ctx) return;
      
      // Calculate 7-day moving average
      const windowSize = 7;
      const movingAvg = [];
      for (let i = 0; i < timeSeries.length; i++) {
        const start = Math.max(0, i - windowSize + 1);
        const slice = timeSeries.slice(start, i + 1);
        const avg = slice.reduce((sum, d) => sum + (d.interactions || 0), 0) / slice.length;
        movingAvg.push(avg);
      }
      
      const labels = timeSeries.map((d, i) => {
        if (i % Math.ceil(timeSeries.length / 10) === 0 || i === timeSeries.length - 1) {
          const date = new Date(d.time * 1000);
          return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        }
        return '';
      });
      
      const interactions = timeSeries.map(d => d.interactions || 0);
      
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Daily Interactions',
            data: interactions,
            borderColor: '#6E54FF',
            backgroundColor: 'rgba(110, 84, 255, 0.1)',
            tension: 0.4,
            fill: false
          }, {
            label: '7-Day Moving Average',
            data: movingAvg,
            borderColor: '#85E6FF',
            backgroundColor: 'rgba(133, 230, 255, 0.1)',
            tension: 0.4,
            fill: false,
            borderDash: [5, 5]
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { 
              display: true, 
              position: 'top',
              labels: {
                font: {
                  family: 'Inter',
                  size: 12
                },
                color: '#1B1D21'
              }
            },
            title: { 
              display: true, 
              text: 'Growth Trend Analysis',
              font: {
                family: 'Inter',
                size: 16,
                weight: 'bold'
              },
              color: '#1B1D21'
            }
          },
          scales: {
            y: { 
              beginAtZero: true, 
              title: { display: true, text: 'Interactions' },
              ticks: {
                font: {
                  family: 'Roboto Mono',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            },
            x: {
              ticks: {
                font: {
                  family: 'Inter',
                  size: 11
                },
                color: '#1B1D21'
              },
              grid: {
                color: 'rgba(110, 84, 255, 0.1)'
              }
            }
          }
        }
      });
    }
    
    function displayResults(data, container) {
      const score = data.investment_readiness_score;
      const scoreClass = score >= 70 ? 'high' : score >= 50 ? 'medium' : 'low';
      
      let html = `
        <div class="score-container">
          <div class="score-label">Investment Readiness Score</div>
          <div class="score-value">${score}</div>
          <div style="margin-top: 10px; font-size: 16px;">${data.narrative}</div>
        </div>
        
        <div class="data-stats">
          <strong>Report Statistics:</strong> ${JSON.stringify(data).length} bytes of data | 
          ${Object.keys(data).length} top-level sections | 
          ${data.network?.total_connections || 0} network connections | 
          ${data.top_posts?.length || 0} posts analyzed
        </div>
        
        <div class="section">
          <h2 class="section-title">Core Metrics</h2>
          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-value">${data.creator.followers.toLocaleString()}</div>
              <div class="metric-label">Followers</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.metrics.engagement_rate.toFixed(2)}%</div>
              <div class="metric-label">Engagement Rate</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.metrics.network_quality_score.toFixed(0)}</div>
              <div class="metric-label">Network Quality</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.metrics.topic_influence_score.toFixed(1)}</div>
              <div class="metric-label">Topic Influence</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.metrics.creator_rank ? '#' + data.metrics.creator_rank.toLocaleString() : 'N/A'}</div>
              <div class="metric-label">Creator Rank</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.network.total_connections}</div>
              <div class="metric-label">Network Size</div>
            </div>
          </div>
        </div>
        
        <div class="section">
          <h2 class="section-title">Key Insights</h2>
          ${data.insights.map(insight => `
            <div class="insight-box">
              <div class="insight-title">${insight.title}</div>
              <div>${insight.message}</div>
            </div>
          `).join('')}
        </div>
        
        <div class="section">
          <h2 class="section-title">Network Analysis (${data.network?.total_connections || 0} Connections)</h2>
          ${((data.network?.top_community || []).slice(0, 20)).map(interactor => `
            <div class="interactor-card">
              <img src="${interactor.creator_avatar || 'data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 100 100%27%3E%3Ccircle cx=%2750%27 cy=%2750%27 r=%2740%27 fill=%27%23ddd%27/%3E%3C/svg%3E'}" 
                   alt="${interactor.creator_name}" 
                   class="interactor-avatar"
                   onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 100 100%27%3E%3Ccircle cx=%2750%27 cy=%2750%27 r=%2740%27 fill=%27%23ddd%27/%3E%3C/svg%3E'">
              <div class="interactor-info">
                <div class="interactor-name">${interactor.creator_display_name || interactor.creator_name}</div>
                <div class="interactor-handle">@${interactor.creator_name}</div>
              </div>
              <div class="interactor-count">${interactor.count || 0}</div>
            </div>
          `).join('')}
        </div>
        
        <div class="section">
          <h2 class="section-title">Topic Influence (${(data.topic_influence || []).length} Topics)</h2>
          <div class="chart-container">
            <canvas id="topicChart"></canvas>
          </div>
          <div style="margin-top: 20px;">
            ${(data.topic_influence || []).map(topic => `
              <span class="topic-tag">
                ${topic.topic}
                ${topic.rank ? `<span class="rank">#${topic.rank}</span>` : ''}
                ${topic.percent ? `(${topic.percent.toFixed(2)}%)` : ''}
              </span>
            `).join('')}
          </div>
        </div>
        
        ${data.time_series && data.time_series.length > 0 ? `
          <div class="section">
            <h2 class="section-title">Engagement Trends</h2>
            <div class="chart-container large">
              <canvas id="timeSeriesChart"></canvas>
            </div>
          </div>
          
          <div class="section">
            <h2 class="section-title">Growth Analysis</h2>
            <div class="chart-container large">
              <canvas id="growthTrendChart"></canvas>
            </div>
          </div>
        ` : ''}
        
        <div class="section">
          <h2 class="section-title">Network Connections Visualization</h2>
          <div class="chart-container large">
            <canvas id="networkChart"></canvas>
          </div>
        </div>
        
        ${data.top_posts && data.top_posts.length > 0 ? `
          <div class="section">
            <h2 class="section-title">Posts Performance</h2>
            <div class="chart-container">
              <canvas id="postsChart"></canvas>
            </div>
          </div>
        ` : ''}
        
        <div class="section">
          <h2 class="section-title">Engagement Metrics Overview</h2>
          <div class="chart-container">
            <canvas id="metricsChart"></canvas>
          </div>
        </div>
        
        ${data.posts_analysis && data.posts_analysis.top_5_posts ? `
          <div class="section">
            <h2 class="section-title">Top 5 Posts Comparison</h2>
            <div class="chart-container">
              <canvas id="topPostsChart"></canvas>
            </div>
          </div>
        ` : ''}
        
        <div class="section">
          <h2 class="section-title">Category Influence</h2>
          ${(data.category_influence || []).length > 0 ? 
            (data.category_influence || []).map(cat => {
              const catName = cat.category || cat.name || 'Unknown';
              const catPercent = (cat.percent || cat.influence || 0).toFixed(2);
              return `<div style="margin: 10px 0;"><strong>${catName}:</strong> ${catPercent}%</div>`;
            }).join('') : 
            '<p style="color: #666;">Category influence data not available for this account.</p>'
          }
        </div>
        
        <div class="section">
          <h2 class="section-title">Derived Intelligence Metrics</h2>
          <div class="metrics-grid">
            <div class="metric-card">
              <div class="metric-value">${data.derived_metrics?.influence_score?.toFixed(0) || 'N/A'}</div>
              <div class="metric-label">Influence Score</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.derived_metrics?.network_density?.toFixed(0) || 'N/A'}</div>
              <div class="metric-label">Network Density</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.derived_metrics?.content_consistency?.toFixed(0) || 'N/A'}</div>
              <div class="metric-label">Content Consistency</div>
            </div>
            <div class="metric-card">
              <div class="metric-value">${data.derived_metrics?.engagement_velocity?.toFixed(2) || 'N/A'}%</div>
              <div class="metric-label">Engagement Velocity</div>
            </div>
          </div>
          ${data.derived_metrics?.exponential_indicators && data.derived_metrics.exponential_indicators.length > 0 ? `
            <h3 style="margin-top: 20px; margin-bottom: 10px;">Exponential Indicators</h3>
            ${data.derived_metrics.exponential_indicators.map(ind => `
              <div class="insight-box" style="background: ${ind.type === 'positive' ? 'rgba(133, 230, 255, 0.1)' : 'rgba(255, 142, 228, 0.1)'}; border-color: ${ind.type === 'positive' ? '#85E6FF' : '#FF8EE4'};">
                <div class="insight-title">${ind.indicator.replace(/_/g, ' ').toUpperCase()}</div>
                <div>${ind.message}</div>
                <div style="margin-top: 5px; font-size: 12px; color: #666;">Strength: ${ind.strength}</div>
              </div>
            `).join('')}
          ` : ''}
        </div>
        
        <div class="section">
          <h2 class="section-title">Investment Recommendations</h2>
          ${data.recommendations && data.recommendations.length > 0 ? data.recommendations.map(rec => `
            <div class="insight-box" style="background: ${rec.priority === 'high' ? 'rgba(110, 84, 255, 0.1)' : rec.priority === 'medium' ? 'rgba(255, 174, 69, 0.1)' : 'rgba(221, 215, 254, 0.3)'}; border-color: ${rec.priority === 'high' ? '#6E54FF' : rec.priority === 'medium' ? '#FFAE45' : '#DDD7FE'};">
              <div class="insight-title">${rec.action} (Priority: ${rec.priority})</div>
              <div style="margin: 10px 0;">${rec.reasoning}</div>
              <div style="margin-top: 10px;">
                <strong>Next Steps:</strong>
                <ul style="margin-left: 20px; margin-top: 5px;">
                  ${rec.next_steps.map(step => `<li>${step}</li>`).join('')}
                </ul>
              </div>
            </div>
          `).join('') : '<p>No specific recommendations available.</p>'}
        </div>
      `;
      
      if (data.top_posts && data.top_posts.length > 0) {
        const topPostsHtml = data.top_posts.slice(0, 10).map((post, idx) => {
          const borderColor = idx === 0 ? '#85E6FF' : idx < 3 ? '#FFAE45' : '#6E54FF';
          const interactions = (post.interactions_total || post.interactions_24h || 0);
          const postDate = post.post_created ? new Date(post.post_created * 1000).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' }) : '';
          const sentiment = post.post_sentiment ? post.post_sentiment.toFixed(1) : 'N/A';
          const postText = post.post_title || post.text || post.content || 'N/A';
          const imageHtml = post.post_image ? `<img src="${post.post_image}" style="max-width: 100%; max-height: 300px; border-radius: 8px; margin-top: 10px; object-fit: cover;" onerror="this.style.display='none'">` : '';
          
          return `
            <div class="post-item" style="border-left: 4px solid ${borderColor}; padding-left: 15px; margin-bottom: 20px;">
              <div style="display: flex; gap: 15px;">
                <div style="flex: 1;">
                  <div style="font-size: 12px; color: #666; margin-bottom: 5px;">#${idx + 1} Most Engaging</div>
                  <div class="post-text" style="white-space: pre-wrap; line-height: 1.6; font-size: 15px; margin-bottom: 10px;">${postText}</div>
                  ${imageHtml}
                  <div class="post-meta" style="margin-top: 10px;">
                      <a href="${post.post_link || '#'}" target="_blank" style="color: #6E54FF; text-decoration: none; font-weight: bold;">View Tweet </a> |
                    ${postDate} | 
                    Sentiment: ${sentiment}/5.0
                  </div>
                </div>
                <div style="text-align: right; min-width: 100px;">
                  <div style="font-size: 32px; font-weight: bold; color: #6E54FF; line-height: 1; font-family: 'Roboto Mono', monospace;">${interactions.toLocaleString()}</div>
                  <div style="font-size: 12px; color: #666; margin-top: 5px;">interactions</div>
                </div>
              </div>
            </div>
          `;
        }).join('');
        
        const postsAnalysisHtml = data.posts_analysis ? `
          <div style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px;">
            <strong>Posts Analysis:</strong> ${(data.posts_analysis.total_interactions || 0).toLocaleString()} total interactions | 
            ${(data.posts_analysis.avg_interactions || 0).toFixed(0)} avg per post | 
            ${data.posts_analysis.viral_posts || 0} viral posts (500+ interactions)
          </div>
        ` : '';
        
        html += `
          <div class="section">
            <h2 class="section-title">Key Tweets (Top ${Math.min(10, data.top_posts.length)} by Engagement)</h2>
            ${topPostsHtml}
            ${postsAnalysisHtml}
          </div>
        `;
      }
      
      container.innerHTML = html;
      
      // Render all charts after DOM is updated
      setTimeout(() => {
        if (data.time_series && data.time_series.length > 0) {
          renderTimeSeriesChart(data.time_series, 'timeSeriesChart');
          renderGrowthTrendChart(data.time_series, 'growthTrendChart');
        }
        if (data.topic_influence && data.topic_influence.length > 0) {
          renderTopicInfluenceChart(data.topic_influence, 'topicChart');
        }
        if (data.network && data.network.top_community && data.network.top_community.length > 0) {
          renderNetworkConnectionsChart(data.network.top_community, 'networkChart');
        }
        if (data.top_posts && data.top_posts.length > 0) {
          renderPostsPerformanceChart(data.top_posts, 'postsChart');
        }
        if (data.metrics) {
          renderEngagementMetricsChart(data.metrics, 'metricsChart');
        }
        if (data.posts_analysis && data.posts_analysis.top_5_posts) {
          renderTopPostsComparisonChart(data.posts_analysis, 'topPostsChart');
        }
      }, 100);
    }
    
    function downloadJSON() {
      if (!window.reportData) {
        alert('No report data available');
        return;
      }
      const blob = new Blob([JSON.stringify(window.reportData, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${window.reportData.handle}-10x-report.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
    
    // Enter key support
    document.getElementById('handle').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        generateReport();
      }
    });
  </script>
</body>
</html>

